<UserControl x:Class="BudgetPlanner.PresentationLayer.Views.BudgetPostsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:domain="clr-namespace:BudgetPlanner.DomainLayer.Enums">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- FILTER BAR -->
        <StackPanel Orientation="Horizontal" Margin="0 0 0 15" Grid.Row="0" VerticalAlignment="Center">

            <!-- Sökfält -->
            <TextBox Width="200"
                     Margin="0 0 10 0"
                     Text="{Binding SearchText}"
                     VerticalAlignment="Center"
                     Foreground="Gray">
                <TextBox.Style>
                    <Style TargetType="TextBox">
                        <Setter Property="Foreground" Value="Gray"/>
                        <Style.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter Property="Foreground" Value="Black"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TextBox.Style>
            </TextBox>

            <!-- Kategori-filter -->
            <ComboBox Width="150"
                      Margin="0 0 10 0"
                      ItemsSource="{Binding Categories}"
                      SelectedItem="{Binding SelectedCategory}" />

            <!-- Typ-filter (Baseras på enum) -->
            <ComboBox Width="150"
                      Margin="0 0 10 0"
                      SelectedItem="{Binding SelectedType}">
                <ComboBox.ItemsSource>
                    <x:Array Type="{x:Type domain:BudgetPostType}">
                        <domain:BudgetPostType>Income</domain:BudgetPostType>
                        <domain:BudgetPostType>Expense</domain:BudgetPostType>
                    </x:Array>
                </ComboBox.ItemsSource>
            </ComboBox>

            <!-- Datumintervall -->
            <DatePicker SelectedDate="{Binding FromDate}"
                        Margin="0 0 10 0"/>
            <DatePicker SelectedDate="{Binding ToDate}"
                        Margin="0 0 10 0"/>

            <!-- Ny post -->
            <Button Content="Ny budgetpost"
                    Command="{Binding AddNewBudgetPostCommand}"
                    Padding="8,4" />
        </StackPanel>

        <!-- DATA GRID -->
        <DataGrid Grid.Row="1"
           ItemsSource="{Binding FilteredPosts}"
           AutoGenerateColumns="False"
           CanUserAddRows="False"
           IsReadOnly="True">

            <DataGrid.Columns>
                <DataGridTextColumn Header="Datum"
                Binding="{Binding Date}" />
                
                <DataGridTextColumn Header="Typ"
                 Binding="{Binding Type}" />

                <DataGridTextColumn Header="Kategori" 
                                    Binding="{Binding Category}"/>

                <DataGridTextColumn Header="Belopp"
                 Binding="{Binding Amount}" />

                <!-- Actions -->
                <DataGridTemplateColumn Header="Åtgärder" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">

                                <Button Content="✏️"
                     Width="30"
                     Margin="2"
                     Command="{Binding DataContext.EditPostCommand,
                               RelativeSource={RelativeSource AncestorType=UserControl}}"
                     CommandParameter="{Binding}"/>

                                <Button Content="🗑️"
                     Width="30"
                     Margin="2"
                     Command="{Binding DataContext.DeletePostCommand,
                               RelativeSource={RelativeSource AncestorType=UserControl}}"
                     CommandParameter="{Binding}"/>

                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>

        </DataGrid>
    </Grid>
</UserControl>
    
    
    
   